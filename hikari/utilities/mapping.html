<!--
Copyright (c) 2020 Nekokatt
Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:
The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.
THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
-->
<!--
Copyright (c) 2020 Nekokatt
Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:
The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.
THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
-->
<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>hikari.utilities.mapping API documentation</title>
<meta name="description" content="Mapping utility and implementations used in Hriki." />
<meta property="og:title" content="hikari.utilities.mapping module documentation" />
<meta property="og:type" content="website" />
<meta property="og:image" content="https://nekokatt.github.io/hikari/logo.png" />
<meta property="og:description" content="A Discord Bot framework for modern Python and asyncio built on good intentions" />
<meta property="theme-color" content="#ff029a" />
<link rel="shortcut icon" type="image/png" href="https://nekokatt.github.io/hikari/logo.png"/>
<!--<script async src="https://cse.google.com/cse.js?cx=017837193012385208679:pey8ky8gdqw"></script>
<style>.gsc-control-cse {padding:0 !important;margin-top:1em}</style>-->
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-dark.min.css" rel="stylesheet"/>
<style>
* {
scrollbar-color: #202324 #454a4d;
scroll-behavior: smooth;
}
img#logo {
border-radius: 15px;
width: 30px;
height: 30px;
margin-right: 0.5em;
}
small.smaller {
font-size: 0.75em;
}
body {
background-color: #181A1B;
color: #C9C5C0;
}
h1 {
margin-top: 3rem;
}
h2 {
margin-top: 1.75rem;
margin-bottom: 1em;
}
h3 {
margin-top: 1.25rem;
}
h4 {
margin-top: 1rem;
}
.nav-section {
margin-top: 2em;
}
.monospaced {
font-family: SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
}
a.sidebar-nav-pill,
a.sidebar-nav-pill:active,
a.sidebar-nav-pill:hover {
color: #BDB7AF;
}
.module-source > details > pre {
display: block;
overflow-x: auto;
overflow-y: auto;
max-height: 600px;
font-size: 0.8em;
}
a {
color: #DE4F91;
}
a:hover {
color: #64B1F2;
}
.jumbotron {
background-color: #232627;
}
.breadcrumb-item.inactive > a {
color: #d264d0 !important;
}
.breadcrumb-item.active > a {
color: #de4f91 !important;
}
.breadcrumb-item+.breadcrumb-item::before {
content: ".";
}
.module-breadcrumb {
padding-left: 0 !important;
background-color: #232627;
}
ul.nested {
margin-left: 1em;
}
h2#parameters::after {
margin-left: 2em;
}
dt {
margin-left: 2em;
}
dd {
margin-left: 4em;
}
dl.no-nest > dt {
margin-left: 0em;
}
dl.no-nest > dd {
margin-left: 2em;
}
dl.root {
margin-bottom: 2em;
}
.definition {
display: block;
margin-bottom: 8em !important;
}
.definition .row {
display: block;
margin-bottom: 4em !important;
}
.definition h2 {
font-size: 1em;
font-weight: bolder;
}
.sep {
height: 2em;
}
code {
color: #DB61D9;
}
code .active {
color: #e83e8c;
}
code a {
color: #E94A93;
}
a.dotted:hover, abbr:hover {
text-decoration: underline #9E9689 dotted !important;
}
a.dotted, abbr {
text-decoration: none !important;
}
.gsc-search-box, .gsc-search-box-tools, .gsc-control-cse {
background: none !important;
border: none !important;
}
.gsc-search-button-v2, .gsc-search-button-v2:hover, .gsc-search-button-v2:focus {
color: var(--success) !important;
border-color: var(--success) !important;
background: none !important;
padding: 6px 32px !important;
font-size: inherit !important;
}
.gsc-search-button-v2 > svg {
fill: var(--success) !important;
}
.gsc-input-box {
border-radius: 3px;
}
.gsc-control-cse {
width: 300px !important;
margin-top: 0 !important;
}
.gsc-control-cse .gsc-control-cse-en {
margin-top: 0 !important;
}
.bg-dark {
background-color: #2C2F31 !important;
}
.text-muted {
color: #9E9689 !important;
}
.alert-primary {
color: #7CC3FF;
background-color: #262A2B;
border-color: #003B7B;
}
.alert-secondary {
color: #C2BCB4;
background-color: #282B2C;
border-color: #3B4042;
}
.alert-success {
color: #99E6AB;
background-color: #1A3E29;
border-color: #255A32;
}
.alert-info {
color: #8EE3F1;
background-color: #143B43;
border-color: #1E5961;
}
.alert-warning {
color: #FBD770;
background-color: #513E00;
border-color: #7B5C00;
}
.alert-danger {
color: rgb(225, 134, 143);
background-color: rgb(67, 12, 17);
border-color: rgb(104, 18, 27);
}
mark {
background-color: #333333;
border-radius: 0.1em;
color: #DB61D9;
}
</style>
<script async src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS_CHTML'></script>
</head>
<body>
<!-- body.mako -->
<nav id="main-nav" class="navbar navbar-dark navbar-expand-lg bg-dark">
<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
<span class="navbar-toggler-icon"/>
</button>
<a class="navbar-brand" href="https://github.com/nekokatt/hikari"><img class="d-inline-block align-top" src="https://nekokatt.github.io/hikari/logo.png" id="logo" alt="hikari logo" loading="lazy"/>Hikari <small>v2.0.0.dev82</small></a>
<div class="collapse navbar-collapse" id="navbarNavDropdown">
<ul class="navbar-nav mr-auto">
<li class="nav-item"><a class="nav-link" href="/hikari/index.html">Home</a></li>
<li class="nav-item active"><a class="nav-link" href="/hikari/hikari/index.html">Documentation</a></li>
<li class="nav-item"><a class="nav-link" href="https://github.com/nekokatt/hikari">GitHub</a></li>
<li class="nav-item"><a class="nav-link" href="https://pypi.org/project/hikari">PyPI</a></li>
<li class="nav-item"><a class="nav-link" href="https://discord.gg/Jx4cNGG">Discord Server</a></li>
</ul>
<form class="form-inline" >
<input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search" id="lunr-search"/>
<button class="btn btn-outline-success my-2 my-sm-0" type="submit">&gt;</button>
</form>
</div>
</nav>
<div class="jumbotron jumbotron-fluid">
<div class="container">
<h1 class="display-4"><code>
<nav aria-label="breadcrumb">
<ol class="breadcrumb module-breadcrumb">
<li class="breadcrumb-item inactive"><a title="hikari -- A sane Python framework for writing modern Discord bots …" href="../index.html"
class='dotted'>hikari</a></li>
<li class="breadcrumb-item inactive"><a title="hikari.utilities -- Package containing internal utilities used within this API." href="index.html"
class='dotted'>utilities</a></li>
<li class="breadcrumb-item active"><a href="#">mapping</a></li>
</ol>
</nav>
</code></h1>
<p class="lead"><p>Mapping utility and implementations used in Hriki.</p></p>
</div>
</div>
<div class="container-xl">
<div class="row">
<div class="d-md-none d-lg-block col-lg-5 col-xl-4">
<!--<nav class="nav" id="content-nav">-->
<h3>This module</h3>
<ul class="list-unstyled text-truncate">
<li class="text-truncate monospaced"><small class='text-muted'><em><abbr title='A standard variable'>var</abbr></em></small> <a title="KeyT -- Type-hint A type hint used for the type of a mapping's key." href="#hikari.utilities.mapping.KeyT"
class='sidebar-nav-pill'>KeyT</a></li>
<li class="text-truncate monospaced"><small class='text-muted'><em><abbr title='A standard variable'>var</abbr></em></small> <a title="MapT -- Type-hint A type hint used for mapped collection objects." href="#hikari.utilities.mapping.MapT"
class='sidebar-nav-pill'>MapT</a></li>
<li class="text-truncate monospaced"><small class='text-muted'><em><abbr title='A standard variable'>var</abbr></em></small> <a title="ValueT -- Type-hint A type hint used for the type of a mapping's value." href="#hikari.utilities.mapping.ValueT"
class='sidebar-nav-pill'>ValueT</a></li>
</ul>
<ul class="list-unstyled text-truncate">
<li class="text-truncate monospaced"><small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="copy_mapping -- Logic for copying mappings that targets implementation specific copy impls (e.g. dict.copy) …" href="#hikari.utilities.mapping.copy_mapping"
class='sidebar-nav-pill'>copy_mapping</a></li>
<li class="text-truncate monospaced"><small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="get_index_or_slice -- Get a mapping's entry at a given index as if it's a sequence of it's values …" href="#hikari.utilities.mapping.get_index_or_slice"
class='sidebar-nav-pill'>get_index_or_slice</a></li>
</ul>
<ul class="list-unstyled text-truncate">
<li class="monospaced">
<small class='text-muted'><em><abbr title='A standard Python type.'>class</abbr></em></small> <a title="CMRIMutableMapping -- Implementation of a capacity-limited most-recently-inserted mapping …" href="#hikari.utilities.mapping.CMRIMutableMapping"
class='sidebar-nav-pill'>CMRIMutableMapping</a>
<ul class="list-unstyled nested text-truncate">
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="copy -- Return a copy of this mapped collection …" href="#hikari.utilities.mapping.CMRIMutableMapping.copy"
class='sidebar-nav-pill'>copy</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="freeze -- Return a frozen mapping view of the items in this mapped collection …" href="#hikari.utilities.mapping.CMRIMutableMapping.freeze"
class='sidebar-nav-pill'>freeze</a>
</li>
<br />
</ul>
</li>
<li class="monospaced">
<small class='text-muted'><em><abbr title='A standard Python type.'>class</abbr></em></small> <a title="DictionaryCollection -- A basic mapped collection that acts like a dictionary." href="#hikari.utilities.mapping.DictionaryCollection"
class='sidebar-nav-pill'>DictionaryCollection</a>
<ul class="list-unstyled nested text-truncate">
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="copy -- Return a copy of this mapped collection …" href="#hikari.utilities.mapping.DictionaryCollection.copy"
class='sidebar-nav-pill'>copy</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="freeze -- Return a frozen mapping view of the items in this mapped collection …" href="#hikari.utilities.mapping.DictionaryCollection.freeze"
class='sidebar-nav-pill'>freeze</a>
</li>
<br />
</ul>
</li>
<li class="monospaced">
<small class='text-muted'><em><abbr title='A standard Python type.'>class</abbr></em></small> <a title="MRIMutableMapping -- A most-recently-inserted limited mutable mapping implementation …" href="#hikari.utilities.mapping.MRIMutableMapping"
class='sidebar-nav-pill'>MRIMutableMapping</a>
<ul class="list-unstyled nested text-truncate">
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="copy -- Return a copy of this mapped collection …" href="#hikari.utilities.mapping.MRIMutableMapping.copy"
class='sidebar-nav-pill'>copy</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="freeze -- Return a frozen mapping view of the items in this mapped collection …" href="#hikari.utilities.mapping.MRIMutableMapping.freeze"
class='sidebar-nav-pill'>freeze</a>
</li>
<br />
</ul>
</li>
<li class="monospaced">
<small class='text-muted'><em><abbr title='A standard Python type.'>class</abbr></em></small> <a title="MappedCollection -- The abstract class of mutable mappings used within hikari …" href="#hikari.utilities.mapping.MappedCollection"
class='sidebar-nav-pill'>MappedCollection</a>
<ul class="list-unstyled nested text-truncate">
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="copy -- Return a copy of this mapped collection …" href="#hikari.utilities.mapping.MappedCollection.copy"
class='sidebar-nav-pill'>copy</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="freeze -- Return a frozen mapping view of the items in this mapped collection …" href="#hikari.utilities.mapping.MappedCollection.freeze"
class='sidebar-nav-pill'>freeze</a>
</li>
<br />
</ul>
</li>
</ul>
<!--</nav>-->
</div>
<div class="col-xs-12 col-lg-7 col-xl-8">
<div class="row">
<div class="col module-source">
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/nekokatt/hikari/blob/9b79731e2cd6e31eb8e2c5fed844a6d4527ac378/hikari/utilities/mapping.py#L0-L312" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python"># -*- coding: utf-8 -*-
# cython: language_level=3
# Copyright (c) 2020 Nekokatt
#
# Permission is hereby granted, free of charge, to any person obtaining a copy
# of this software and associated documentation files (the &#34;Software&#34;), to deal
# in the Software without restriction, including without limitation the rights
# to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
# copies of the Software, and to permit persons to whom the Software is
# furnished to do so, subject to the following conditions:
#
# The above copyright notice and this permission notice shall be included in all
# copies or substantial portions of the Software.
#
# THE SOFTWARE IS PROVIDED &#34;AS IS&#34;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
# IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
# FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
# AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
# LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
# OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
# SOFTWARE.
&#34;&#34;&#34;Mapping utility and implementations used in Hriki.&#34;&#34;&#34;
from __future__ import annotations

__all__: typing.Sequence[str] = [
    &#34;MapT&#34;,
    &#34;KeyT&#34;,
    &#34;ValueT&#34;,
    &#34;MappedCollection&#34;,
    &#34;DictionaryCollection&#34;,
    &#34;MRIMutableMapping&#34;,
    &#34;CMRIMutableMapping&#34;,
    &#34;get_index_or_slice&#34;,
    &#34;copy_mapping&#34;,
]

import abc
import datetime
import itertools
import time
import typing

MapT = typing.TypeVar(&#34;MapT&#34;, bound=&#34;MappedCollection[typing.Any, typing.Any]&#34;)
&#34;&#34;&#34;Type-hint A type hint used for mapped collection objects.&#34;&#34;&#34;
KeyT = typing.TypeVar(&#34;KeyT&#34;, bound=typing.Hashable)
&#34;&#34;&#34;Type-hint A type hint used for the type of a mapping&#39;s key.&#34;&#34;&#34;
ValueT = typing.TypeVar(&#34;ValueT&#34;)
&#34;&#34;&#34;Type-hint A type hint used for the type of a mapping&#39;s value.&#34;&#34;&#34;


class MappedCollection(typing.MutableMapping[KeyT, ValueT], abc.ABC):
    &#34;&#34;&#34;The abstract class of mutable mappings used within hikari.

    This extends `typing.MutableMapping` with &#34;copy&#34; and &#34;freeze&#34; methods.
    &#34;&#34;&#34;

    __slots__: typing.Sequence[str] = ()

    @abc.abstractmethod
    def copy(self: MapT) -&gt; MapT:
        &#34;&#34;&#34;Return a copy of this mapped collection.

        Unlike simply doing `dict(mapping)`, this may rely on internal detail
        around how the data is being stored to allow for a more efficient copy.
        This may look like calling `dict.copy` and wrapping the result in a
        mapped collection.

        !!! note
            Any removal policy on this mapped collection will be copied over.

        Returns
        -------
        MapT[KeyT, ValueT]
            A copy of this mapped collection.
        &#34;&#34;&#34;

    @abc.abstractmethod
    def freeze(self) -&gt; typing.MutableMapping[KeyT, ValueT]:
        &#34;&#34;&#34;Return a frozen mapping view of the items in this mapped collection.

        Unlike simply doing `dict(mapping)`, this may rely on internal detail
        around how the data is being stored to allow for a more efficient copy.
        This may look like calling `dict.copy`.

        !!! note
            Unlike `MappedCollection.copy`, this should return a pure mapping
            with no removal policy at all.

        Returns
        -------
        typing.MutableMapping[KeyT, ValueT]
            A frozen mapping view of the items in this mapped collection.
        &#34;&#34;&#34;


class DictionaryCollection(MappedCollection[KeyT, ValueT]):
    &#34;&#34;&#34;A basic mapped collection that acts like a dictionary.&#34;&#34;&#34;

    __slots__ = (&#34;_data&#34;,)

    def __init__(self, source: typing.Optional[typing.Dict[KeyT, ValueT]] = None, /) -&gt; None:
        self._data = source or {}

    def copy(self) -&gt; DictionaryCollection[KeyT, ValueT]:
        return DictionaryCollection(self._data.copy())

    def freeze(self) -&gt; typing.Dict[KeyT, ValueT]:
        return self._data.copy()

    def __delitem__(self, key: KeyT) -&gt; None:
        del self._data[key]

    def __getitem__(self, key: KeyT) -&gt; ValueT:
        return self._data[key]

    def __iter__(self) -&gt; typing.Iterator[KeyT]:
        return iter(self._data)

    def __len__(self) -&gt; int:
        return len(self._data)

    def __setitem__(self, key: KeyT, value: ValueT) -&gt; None:
        self._data[key] = value


class _FrozenMRIMapping(typing.MutableMapping[KeyT, ValueT]):
    __slots__ = (&#34;_source&#34;,)

    def __init__(self, source: typing.Dict[KeyT, typing.Tuple[float, ValueT]], /) -&gt; None:
        self._source = source

    def __getitem__(self, key: KeyT) -&gt; ValueT:
        return self._source[key][1]

    def __iter__(self) -&gt; typing.Iterator[KeyT]:
        return iter(self._source)

    def __len__(self) -&gt; int:
        return len(self._source)

    def __delitem__(self, key: KeyT) -&gt; None:
        del self._source[key]

    def __setitem__(self, key: KeyT, value: ValueT) -&gt; None:
        self._source[key] = (0.0, value)


class MRIMutableMapping(MappedCollection[KeyT, ValueT]):
    &#34;&#34;&#34;A most-recently-inserted limited mutable mapping implementation.

    This will remove entries on modification as as they pass the expiry limit.

    Parameters
    ----------
    expiry : datetime.timedelta
        The timedelta of how long entries should be stored for before removal.
    source : typing.Optional[typing.Dict[KeyT, typing.Tuple[builtins.float, ValueT]]
        A source dictionary of keys to tuples of float timestamps and values to
        create this from.
    &#34;&#34;&#34;

    __slots__ = (&#34;_data&#34;, &#34;_expiry&#34;)

    def __init__(
        self,
        source: typing.Optional[typing.Dict[KeyT, typing.Tuple[float, ValueT]]] = None,
        /,
        *,
        expiry: datetime.timedelta,
    ) -&gt; None:
        if expiry &lt;= datetime.timedelta():
            raise ValueError(&#34;expiry time must be greater than 0 microseconds.&#34;)

        self._expiry: float = expiry.total_seconds()
        self._data = source or {}
        self._garbage_collect()

    def copy(self) -&gt; MRIMutableMapping[KeyT, ValueT]:
        return MRIMutableMapping(self._data.copy(), expiry=datetime.timedelta(seconds=self._expiry))

    def freeze(self) -&gt; typing.MutableMapping[KeyT, ValueT]:
        return _FrozenMRIMapping(self._data.copy())

    def _garbage_collect(self) -&gt; None:
        current_time = time.perf_counter()
        for key, value in tuple(self._data.items()):
            if current_time - value[0] &lt; self._expiry:
                break

            del self._data[key]

    def __delitem__(self, key: KeyT) -&gt; None:
        del self._data[key]
        self._garbage_collect()

    def __getitem__(self, key: KeyT) -&gt; ValueT:
        return self._data[key][1]

    def __iter__(self) -&gt; typing.Iterator[KeyT]:
        return iter(self._data)

    def __len__(self) -&gt; int:
        return len(self._data)

    def __setitem__(self, key: KeyT, value: ValueT) -&gt; None:
        #  Seeing as we rely on insertion order in _garbage_collect, we have to make sure that each item is added to
        #  the end of the dict.
        if key in self:
            del self[key]

        self._data[key] = (time.perf_counter(), value)
        self._garbage_collect()


class CMRIMutableMapping(MappedCollection[KeyT, ValueT]):
    &#34;&#34;&#34;Implementation of a capacity-limited most-recently-inserted mapping.

    This will start removing the oldest entries after it&#39;s maximum capacity is
    reached as new entries are added.

    Parameters
    ----------
    limit : int
        The limit for how many objects should be stored by this mapping before
        it starts removing the oldest entries.
    source : typing.Optional[typing.Dict[KeyT, ValueT]]
        A source dictionary of keys to values to create this from.
    &#34;&#34;&#34;

    __slots__ = (&#34;_data&#34;, &#34;_limit&#34;)

    def __init__(self, source: typing.Optional[typing.Dict[KeyT, ValueT]] = None, /, *, limit: int) -&gt; None:
        self._data: typing.Dict[KeyT, ValueT] = source or {}
        self._limit = limit
        self._garbage_collect()

    def copy(self) -&gt; CMRIMutableMapping[KeyT, ValueT]:
        return CMRIMutableMapping(self._data.copy(), limit=self._limit)

    def freeze(self) -&gt; typing.Dict[KeyT, ValueT]:
        return self._data.copy()

    def _garbage_collect(self) -&gt; None:
        while len(self._data) &gt; self._limit:
            self._data.pop(next(iter(self._data)))

    def __delitem__(self, key: KeyT) -&gt; None:
        del self._data[key]

    def __getitem__(self, key: KeyT) -&gt; ValueT:
        return self._data[key]

    def __iter__(self) -&gt; typing.Iterator[KeyT]:
        return iter(self._data)

    def __len__(self) -&gt; int:
        return len(self._data)

    def __setitem__(self, key: KeyT, value: ValueT) -&gt; None:
        self._data[key] = value
        self._garbage_collect()


def get_index_or_slice(
    mapping: typing.Mapping[KeyT, ValueT], index_or_slice: typing.Union[int, slice]
) -&gt; typing.Union[ValueT, typing.Sequence[ValueT]]:
    &#34;&#34;&#34;Get a mapping&#39;s entry at a given index as if it&#39;s a sequence of it&#39;s values.

    Parameters
    ----------
    mapping : typing.Mapping[KeyT, ValueT]
        The mapping of entries to treat as a sequence.
    index_or_slice : typing.Sequence[KeyT, ValueT]
        The index to get an entry to get or slice of multiple entries to get.

    Returns
    -------
    ValueT or typing.Sequence[ValueT]
        The value found at the given integer index or a sequence of the values
        found based on the given slice&#39;s rules.

    Raises
    ------
    TypeError
        If `index_or_slice` isn&#39;t a `builtins.slice` or `builtins.int`.
    IndexError
        If `index_or_slice` is an int and is outside the range of the mapping&#39;s
        contents.
    &#34;&#34;&#34;
    if isinstance(index_or_slice, slice):
        return tuple(itertools.islice(mapping.values(), index_or_slice.start, index_or_slice.stop, index_or_slice.step))

    if isinstance(index_or_slice, int):
        try:
            return next(itertools.islice(mapping.values(), index_or_slice, None))
        except StopIteration:
            raise IndexError(index_or_slice) from None

    raise TypeError(f&#34;sequence indices must be integers or slices, not {type(index_or_slice).__name__}&#34;)


def copy_mapping(mapping: typing.Mapping[KeyT, ValueT]) -&gt; typing.MutableMapping[KeyT, ValueT]:
    &#34;&#34;&#34;Logic for copying mappings that targets implementation specific copy impls (e.g. dict.copy).

    .. deprecated::
        `MappedCollection` should be preferred over this.
    &#34;&#34;&#34;
    # dict.copy ranges from between roughly 2 times to 5 times more efficient than casting to a dict so we want to
    # try to use this where possible.
    try:
        return mapping.copy()  # type: ignore[attr-defined, no-any-return]
    except (AttributeError, TypeError):
        raise NotImplementedError(&#34;provided mapping doesn&#39;t implement a copy method&#34;) from None</code></pre>
</details>
</div>
</div>
<h2 id="variables-heading">Variables and Type Hints</h2>
<section class="definition">
<dl class="no-nest root">
<dt>
<pre><code class="python"><small class='text-muted'><em><abbr title='A standard variable'>var</abbr></em></small> <a title="KeyT -- Type-hint A type hint used for the type of a mapping's key." href="#hikari.utilities.mapping.KeyT" id="hikari.utilities.mapping.KeyT" class='dotted'>KeyT</a></code></pre>
</dt>
<dd><p>Type-hint A type hint used for the type of a mapping's key.</p></dd>
<dt>
<pre><code class="python"><small class='text-muted'><em><abbr title='A standard variable'>var</abbr></em></small> <a title="MapT -- Type-hint A type hint used for mapped collection objects." href="#hikari.utilities.mapping.MapT" id="hikari.utilities.mapping.MapT" class='dotted'>MapT</a></code></pre>
</dt>
<dd><p>Type-hint A type hint used for mapped collection objects.</p></dd>
<dt>
<pre><code class="python"><small class='text-muted'><em><abbr title='A standard variable'>var</abbr></em></small> <a title="ValueT -- Type-hint A type hint used for the type of a mapping's value." href="#hikari.utilities.mapping.ValueT" id="hikari.utilities.mapping.ValueT" class='dotted'>ValueT</a></code></pre>
</dt>
<dd><p>Type-hint A type hint used for the type of a mapping's value.</p></dd>
</dl>
</section>
<h2 id="functions-heading">Functions</h2>
<section class="definition">
<dl class="no-nest root">
<dt>
<pre><code id="hikari.utilities.mapping.copy_mapping" class="hljs python"><abbr title='A standard Python function.'>def</abbr> copy_mapping(
    mapping: <a href='https://docs.python.org/3/library/typing.html#typing.Mapping'>Mapping</a>[<a href='#hikari.utilities.mapping.KeyT'>KeyT</a>, <a href='#hikari.utilities.mapping.ValueT'>ValueT</a>],
) -> MutableMapping[~<a href='#hikari.utilities.mapping.KeyT'>KeyT</a>, ~<a href='#hikari.utilities.mapping.ValueT'>ValueT</a>]: ...</code></pre>
</dt>
<dd>
<p>Logic for copying mappings that targets implementation specific copy impls (e.g. dict.copy).</p>
<div class="admonition deprecated">
<p class="admonition-title">Deprecated</p>
<p><code><a href='#hikari.utilities.mapping.MappedCollection'>MappedCollection</a></code> should be preferred over this.</p>
</div>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/nekokatt/hikari/blob/9b79731e2cd6e31eb8e2c5fed844a6d4527ac378/hikari/utilities/mapping.py#L302-L313" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def copy_mapping(mapping: typing.Mapping[KeyT, ValueT]) -&gt; typing.MutableMapping[KeyT, ValueT]:
    &#34;&#34;&#34;Logic for copying mappings that targets implementation specific copy impls (e.g. dict.copy).

    .. deprecated::
        `MappedCollection` should be preferred over this.
    &#34;&#34;&#34;
    # dict.copy ranges from between roughly 2 times to 5 times more efficient than casting to a dict so we want to
    # try to use this where possible.
    try:
        return mapping.copy()  # type: ignore[attr-defined, no-any-return]
    except (AttributeError, TypeError):
        raise NotImplementedError(&#34;provided mapping doesn&#39;t implement a copy method&#34;) from None</code></pre>
</details>
</dd>
<div class="sep"></div>
<dt>
<pre><code id="hikari.utilities.mapping.get_index_or_slice" class="hljs python"><abbr title='A standard Python function.'>def</abbr> get_index_or_slice(
    mapping: <a href='https://docs.python.org/3/library/typing.html#typing.Mapping'>Mapping</a>[<a href='#hikari.utilities.mapping.KeyT'>KeyT</a>, <a href='#hikari.utilities.mapping.ValueT'>ValueT</a>],
    index_or_slice: <a href='https://docs.python.org/3/library/typing.html#typing.Union'>Union</a>[<a href='https://docs.python.org/3/library/functions.html#int'>int</a>, <a href='https://docs.python.org/3/library/functions.html#slice'>slice</a>],
) -> Union[~<a href='#hikari.utilities.mapping.ValueT'>ValueT</a>, Sequence[~<a href='#hikari.utilities.mapping.ValueT'>ValueT</a>]]: ...</code></pre>
</dt>
<dd>
<p>Get a mapping's entry at a given index as if it's a sequence of it's values.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>mapping</code></strong> :&ensp;<code><a href='https://docs.python.org/3/library/typing.html#typing.Mapping'>Mapping</a>[<a href='#hikari.utilities.mapping.KeyT'>KeyT</a>, <a href='#hikari.utilities.mapping.ValueT'>ValueT</a>]</code></dt>
<dd>The mapping of entries to treat as a sequence.</dd>
<dt><strong><code>index_or_slice</code></strong> :&ensp;<code><a href='https://docs.python.org/3/library/typing.html#typing.Sequence'>Sequence</a>[<a href='#hikari.utilities.mapping.KeyT'>KeyT</a>, <a href='#hikari.utilities.mapping.ValueT'>ValueT</a>]</code></dt>
<dd>The index to get an entry to get or slice of multiple entries to get.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='#hikari.utilities.mapping.ValueT'>ValueT</a></code> or <code><a href='https://docs.python.org/3/library/typing.html#typing.Sequence'>Sequence</a>[<a href='#hikari.utilities.mapping.ValueT'>ValueT</a>]</code></dt>
<dd>The value found at the given integer index or a sequence of the values
found based on the given slice's rules.</dd>
</dl>
<h2 id="raises">Raises</h2>
<dl>
<dt><code><a href='https://docs.python.org/3/library/exceptions.html#TypeError'>TypeError</a></code></dt>
<dd>If <code>index_or_slice</code> isn't a <code><a href='https://docs.python.org/3/library/functions.html#slice'>slice</a></code> or <code><a href='https://docs.python.org/3/library/functions.html#int'>int</a></code>.</dd>
<dt><code><a href='https://docs.python.org/3/library/exceptions.html#IndexError'>IndexError</a></code></dt>
<dd>If <code>index_or_slice</code> is an int and is outside the range of the mapping's
contents.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/nekokatt/hikari/blob/9b79731e2cd6e31eb8e2c5fed844a6d4527ac378/hikari/utilities/mapping.py#L264-L299" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def get_index_or_slice(
    mapping: typing.Mapping[KeyT, ValueT], index_or_slice: typing.Union[int, slice]
) -&gt; typing.Union[ValueT, typing.Sequence[ValueT]]:
    &#34;&#34;&#34;Get a mapping&#39;s entry at a given index as if it&#39;s a sequence of it&#39;s values.

    Parameters
    ----------
    mapping : typing.Mapping[KeyT, ValueT]
        The mapping of entries to treat as a sequence.
    index_or_slice : typing.Sequence[KeyT, ValueT]
        The index to get an entry to get or slice of multiple entries to get.

    Returns
    -------
    ValueT or typing.Sequence[ValueT]
        The value found at the given integer index or a sequence of the values
        found based on the given slice&#39;s rules.

    Raises
    ------
    TypeError
        If `index_or_slice` isn&#39;t a `builtins.slice` or `builtins.int`.
    IndexError
        If `index_or_slice` is an int and is outside the range of the mapping&#39;s
        contents.
    &#34;&#34;&#34;
    if isinstance(index_or_slice, slice):
        return tuple(itertools.islice(mapping.values(), index_or_slice.start, index_or_slice.stop, index_or_slice.step))

    if isinstance(index_or_slice, int):
        try:
            return next(itertools.islice(mapping.values(), index_or_slice, None))
        except StopIteration:
            raise IndexError(index_or_slice) from None

    raise TypeError(f&#34;sequence indices must be integers or slices, not {type(index_or_slice).__name__}&#34;)</code></pre>
</details>
</dd>
<div class="sep"></div>
</dl>
</section>
<h2 id="class-heading">Classes</h2>
<section class="definition">
<dl class="no-nest root">
<dt>
<h4><small class='text-muted'><em><abbr title='A standard Python type.'>class</abbr></em></small> <a title="CMRIMutableMapping -- Implementation of a capacity-limited most-recently-inserted mapping …" href="#hikari.utilities.mapping.CMRIMutableMapping"
class='dotted'>CMRIMutableMapping</a></h4>
</dt>
<dd>
<pre><code id="hikari.utilities.mapping.CMRIMutableMapping" class="hljs python"><abbr title='A standard Python type.'>class</abbr> CMRIMutableMapping (
    source: <a href='https://docs.python.org/3/library/typing.html#typing.Optional'>Optional</a>[<a href='https://docs.python.org/3/library/typing.html#typing.Dict'>Dict</a>[<a href='#hikari.utilities.mapping.KeyT'>KeyT</a>, <a href='#hikari.utilities.mapping.ValueT'>ValueT</a>]] = None,
    /,
    *,
    limit: <a href='https://docs.python.org/3/library/functions.html#int'>int</a>,
): ...</code></pre>
<p>Implementation of a capacity-limited most-recently-inserted mapping.</p>
<p>This will start removing the oldest entries after it's maximum capacity is
reached as new entries are added.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>limit</code></strong> :&ensp;<code><a href='https://docs.python.org/3/library/functions.html#int'>int</a></code></dt>
<dd>The limit for how many objects should be stored by this mapping before
it starts removing the oldest entries.</dd>
<dt><strong><code>source</code></strong> :&ensp;<code><a href='https://docs.python.org/3/library/typing.html#typing.Optional'>Optional</a>[<a href='https://docs.python.org/3/library/typing.html#typing.Dict'>Dict</a>[<a href='#hikari.utilities.mapping.KeyT'>KeyT</a>, <a href='#hikari.utilities.mapping.ValueT'>ValueT</a>]]</code></dt>
<dd>A source dictionary of keys to values to create this from.</dd>
</dl>
<div class="sep"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/nekokatt/hikari/blob/9b79731e2cd6e31eb8e2c5fed844a6d4527ac378/hikari/utilities/mapping.py#L215-L261" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">class CMRIMutableMapping(MappedCollection[KeyT, ValueT]):
    &#34;&#34;&#34;Implementation of a capacity-limited most-recently-inserted mapping.

    This will start removing the oldest entries after it&#39;s maximum capacity is
    reached as new entries are added.

    Parameters
    ----------
    limit : int
        The limit for how many objects should be stored by this mapping before
        it starts removing the oldest entries.
    source : typing.Optional[typing.Dict[KeyT, ValueT]]
        A source dictionary of keys to values to create this from.
    &#34;&#34;&#34;

    __slots__ = (&#34;_data&#34;, &#34;_limit&#34;)

    def __init__(self, source: typing.Optional[typing.Dict[KeyT, ValueT]] = None, /, *, limit: int) -&gt; None:
        self._data: typing.Dict[KeyT, ValueT] = source or {}
        self._limit = limit
        self._garbage_collect()

    def copy(self) -&gt; CMRIMutableMapping[KeyT, ValueT]:
        return CMRIMutableMapping(self._data.copy(), limit=self._limit)

    def freeze(self) -&gt; typing.Dict[KeyT, ValueT]:
        return self._data.copy()

    def _garbage_collect(self) -&gt; None:
        while len(self._data) &gt; self._limit:
            self._data.pop(next(iter(self._data)))

    def __delitem__(self, key: KeyT) -&gt; None:
        del self._data[key]

    def __getitem__(self, key: KeyT) -&gt; ValueT:
        return self._data[key]

    def __iter__(self) -&gt; typing.Iterator[KeyT]:
        return iter(self._data)

    def __len__(self) -&gt; int:
        return len(self._data)

    def __setitem__(self, key: KeyT, value: ValueT) -&gt; None:
        self._data[key] = value
        self._garbage_collect()</code></pre>
</details>
<div class="sep"></div>
<h5>Method resolution order</h5>
<dl>
<dt class="nested"><small class='text-muted'><em><abbr title='A standard Python type.'>class</abbr></em></small> <a title="CMRIMutableMapping -- Implementation of a capacity-limited most-recently-inserted mapping …" href="#hikari.utilities.mapping.CMRIMutableMapping"
class='dotted'>CMRIMutableMapping</a></dt>
<dd class="nested"><em class="text-muted">That's this class!</em></dd>
<dt class="nested"><small class='text-muted'><em><abbr title='An abstract base class which may have abstract methods and abstract properties.'>abstract</abbr> <abbr title='A standard Python type.'>class</abbr></em></small> <a title="MappedCollection -- The abstract class of mutable mappings used within hikari …" href="#hikari.utilities.mapping.MappedCollection"
class='dotted'>MappedCollection</a></dt>
<dd class="nested"><p>The abstract class of mutable mappings used within hikari …</p></dd>
<dt class="nested"><small class='text-muted'><em><abbr title='Anything that is external to this library.'>extern</abbr> class</em></small> <a title="collections.abc.MutableMapping -- " href="https://docs.python.org/3/library/collections.abc.html#collections.abc.MutableMapping"
class='dotted'>collections.abc.MutableMapping</a></dt>
<dd class="nested"></dd>
<dt class="nested"><small class='text-muted'><em><abbr title='Anything that is external to this library.'>extern</abbr> class</em></small> <a title="collections.abc.Mapping -- " href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping"
class='dotted'>collections.abc.Mapping</a></dt>
<dd class="nested"></dd>
<dt class="nested"><small class='text-muted'><em><abbr title='Anything that is external to this library.'>extern</abbr> class</em></small> <a title="collections.abc.Collection -- " href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Collection"
class='dotted'>collections.abc.Collection</a></dt>
<dd class="nested"></dd>
<dt class="nested"><small class='text-muted'><em><abbr title='Anything that is external to this library.'>extern</abbr> class</em></small> <a title="collections.abc.Sized -- " href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sized"
class='dotted'>collections.abc.Sized</a></dt>
<dd class="nested"></dd>
<dt class="nested"><small class='text-muted'><em><abbr title='Anything that is external to this library.'>extern</abbr> class</em></small> <a title="collections.abc.Iterable -- " href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Iterable"
class='dotted'>collections.abc.Iterable</a></dt>
<dd class="nested"></dd>
<dt class="nested"><small class='text-muted'><em><abbr title='Anything that is external to this library.'>extern</abbr> class</em></small> <a title="collections.abc.Container -- " href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Container"
class='dotted'>collections.abc.Container</a></dt>
<dd class="nested"></dd>
<dt class="nested"><small class='text-muted'><em><abbr title='Anything that is external to this library.'>extern</abbr> class</em></small> <a title="typing.Generic -- Abstract base class for generic types …" href="https://docs.python.org/3/library/typing.html#typing.Generic"
class='dotted'>Generic</a></dt>
<dd class="nested"><p>Abstract base class for generic types …</p></dd>
<dt class="nested"><small class='text-muted'><em><abbr title='Anything that is external to this library.'>extern</abbr> class</em></small> <a title="abc.ABC -- Helper class that provides a standard way to create an ABC using
inheritance." href="https://docs.python.org/3/library/abc.html#abc.ABC"
class='dotted'>abc.ABC</a></dt>
<dd class="nested"><p>Helper class that provides a standard way to create an ABC using
inheritance.</p></dd>
</dl>
<div class="sep"></div>
<h5>Methods</h5>
<dl>
<dt>
<pre><code id="hikari.utilities.mapping.CMRIMutableMapping.copy" class="hljs python"><abbr title='A standard Python function.'>def</abbr> copy() -> <a href='#hikari.utilities.mapping.CMRIMutableMapping'>CMRIMutableMapping</a>[~<a href='#hikari.utilities.mapping.KeyT'>KeyT</a>, ~<a href='#hikari.utilities.mapping.ValueT'>ValueT</a>]: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="MappedCollection -- The abstract class of mutable mappings used within hikari …" href="#hikari.utilities.mapping.MappedCollection"
class='dotted'>MappedCollection</a></code>.<code><a title="copy -- Return a copy of this mapped collection …" href="#hikari.utilities.mapping.MappedCollection.copy"
class='dotted'>copy</a></code>
</p>
<p>Return a copy of this mapped collection.</p>
<p>Unlike simply doing <code><a href='https://docs.python.org/3/library/stdtypes.html#dict'>dict</a>(<a href='https://docs.python.org/3/c-api/mapping.html#mapping'>mapping</a>)</code>, this may rely on internal detail
around how the data is being stored to allow for a more efficient copy.
This may look like calling <code><a href='https://docs.python.org/3/library/stdtypes.html#dict.copy'>dict.copy</a></code> and wrapping the result in a
mapped collection.</p>
<div class="alert alert-success">
<p class="admonition-title">Note</p>
<p>Any removal policy on this mapped collection will be copied over.</p>
</div>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='#hikari.utilities.mapping.MapT'>MapT</a>[<a href='#hikari.utilities.mapping.KeyT'>KeyT</a>, <a href='#hikari.utilities.mapping.ValueT'>ValueT</a>]</code></dt>
<dd>A copy of this mapped collection.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/nekokatt/hikari/blob/9b79731e2cd6e31eb8e2c5fed844a6d4527ac378/hikari/utilities/mapping.py#L237-L238" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def copy(self) -&gt; CMRIMutableMapping[KeyT, ValueT]:
    return CMRIMutableMapping(self._data.copy(), limit=self._limit)</code></pre>
</details>
</dd>
<div class="sep"></div>
<dt>
<pre><code id="hikari.utilities.mapping.CMRIMutableMapping.freeze" class="hljs python"><abbr title='A standard Python function.'>def</abbr> freeze() -> Dict[~<a href='#hikari.utilities.mapping.KeyT'>KeyT</a>, ~<a href='#hikari.utilities.mapping.ValueT'>ValueT</a>]: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="MappedCollection -- The abstract class of mutable mappings used within hikari …" href="#hikari.utilities.mapping.MappedCollection"
class='dotted'>MappedCollection</a></code>.<code><a title="freeze -- Return a frozen mapping view of the items in this mapped collection …" href="#hikari.utilities.mapping.MappedCollection.freeze"
class='dotted'>freeze</a></code>
</p>
<p>Return a frozen mapping view of the items in this mapped collection.</p>
<p>Unlike simply doing <code><a href='https://docs.python.org/3/library/stdtypes.html#dict'>dict</a>(<a href='https://docs.python.org/3/c-api/mapping.html#mapping'>mapping</a>)</code>, this may rely on internal detail
around how the data is being stored to allow for a more efficient copy.
This may look like calling <code><a href='https://docs.python.org/3/library/stdtypes.html#dict.copy'>dict.copy</a></code>.</p>
<div class="alert alert-success">
<p class="admonition-title">Note</p>
<p>Unlike <code><a href='#hikari.utilities.mapping.MappedCollection.copy'>copy</a></code>, this should return a pure mapping
with no removal policy at all.</p>
</div>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='https://docs.python.org/3/library/typing.html#typing.MutableMapping'>MutableMapping</a>[<a href='#hikari.utilities.mapping.KeyT'>KeyT</a>, <a href='#hikari.utilities.mapping.ValueT'>ValueT</a>]</code></dt>
<dd>A frozen mapping view of the items in this mapped collection.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/nekokatt/hikari/blob/9b79731e2cd6e31eb8e2c5fed844a6d4527ac378/hikari/utilities/mapping.py#L240-L241" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def freeze(self) -&gt; typing.Dict[KeyT, ValueT]:
    return self._data.copy()</code></pre>
</details>
</dd>
<div class="sep"></div>
</dl>
<div class="sep"></div>
</dd>
<dt>
<h4><small class='text-muted'><em><abbr title='A standard Python type.'>class</abbr></em></small> <a title="DictionaryCollection -- A basic mapped collection that acts like a dictionary." href="#hikari.utilities.mapping.DictionaryCollection"
class='dotted'>DictionaryCollection</a></h4>
</dt>
<dd>
<pre><code id="hikari.utilities.mapping.DictionaryCollection" class="hljs python"><abbr title='A standard Python type.'>class</abbr> DictionaryCollection (
    source: <a href='https://docs.python.org/3/library/typing.html#typing.Optional'>Optional</a>[<a href='https://docs.python.org/3/library/typing.html#typing.Dict'>Dict</a>[<a href='#hikari.utilities.mapping.KeyT'>KeyT</a>, <a href='#hikari.utilities.mapping.ValueT'>ValueT</a>]] = None,
    /,
): ...</code></pre>
<p>A basic mapped collection that acts like a dictionary.</p>
<div class="sep"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/nekokatt/hikari/blob/9b79731e2cd6e31eb8e2c5fed844a6d4527ac378/hikari/utilities/mapping.py#L96-L123" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">class DictionaryCollection(MappedCollection[KeyT, ValueT]):
    &#34;&#34;&#34;A basic mapped collection that acts like a dictionary.&#34;&#34;&#34;

    __slots__ = (&#34;_data&#34;,)

    def __init__(self, source: typing.Optional[typing.Dict[KeyT, ValueT]] = None, /) -&gt; None:
        self._data = source or {}

    def copy(self) -&gt; DictionaryCollection[KeyT, ValueT]:
        return DictionaryCollection(self._data.copy())

    def freeze(self) -&gt; typing.Dict[KeyT, ValueT]:
        return self._data.copy()

    def __delitem__(self, key: KeyT) -&gt; None:
        del self._data[key]

    def __getitem__(self, key: KeyT) -&gt; ValueT:
        return self._data[key]

    def __iter__(self) -&gt; typing.Iterator[KeyT]:
        return iter(self._data)

    def __len__(self) -&gt; int:
        return len(self._data)

    def __setitem__(self, key: KeyT, value: ValueT) -&gt; None:
        self._data[key] = value</code></pre>
</details>
<div class="sep"></div>
<h5>Method resolution order</h5>
<dl>
<dt class="nested"><small class='text-muted'><em><abbr title='A standard Python type.'>class</abbr></em></small> <a title="DictionaryCollection -- A basic mapped collection that acts like a dictionary." href="#hikari.utilities.mapping.DictionaryCollection"
class='dotted'>DictionaryCollection</a></dt>
<dd class="nested"><em class="text-muted">That's this class!</em></dd>
<dt class="nested"><small class='text-muted'><em><abbr title='An abstract base class which may have abstract methods and abstract properties.'>abstract</abbr> <abbr title='A standard Python type.'>class</abbr></em></small> <a title="MappedCollection -- The abstract class of mutable mappings used within hikari …" href="#hikari.utilities.mapping.MappedCollection"
class='dotted'>MappedCollection</a></dt>
<dd class="nested"><p>The abstract class of mutable mappings used within hikari …</p></dd>
<dt class="nested"><small class='text-muted'><em><abbr title='Anything that is external to this library.'>extern</abbr> class</em></small> <a title="collections.abc.MutableMapping -- " href="https://docs.python.org/3/library/collections.abc.html#collections.abc.MutableMapping"
class='dotted'>collections.abc.MutableMapping</a></dt>
<dd class="nested"></dd>
<dt class="nested"><small class='text-muted'><em><abbr title='Anything that is external to this library.'>extern</abbr> class</em></small> <a title="collections.abc.Mapping -- " href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping"
class='dotted'>collections.abc.Mapping</a></dt>
<dd class="nested"></dd>
<dt class="nested"><small class='text-muted'><em><abbr title='Anything that is external to this library.'>extern</abbr> class</em></small> <a title="collections.abc.Collection -- " href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Collection"
class='dotted'>collections.abc.Collection</a></dt>
<dd class="nested"></dd>
<dt class="nested"><small class='text-muted'><em><abbr title='Anything that is external to this library.'>extern</abbr> class</em></small> <a title="collections.abc.Sized -- " href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sized"
class='dotted'>collections.abc.Sized</a></dt>
<dd class="nested"></dd>
<dt class="nested"><small class='text-muted'><em><abbr title='Anything that is external to this library.'>extern</abbr> class</em></small> <a title="collections.abc.Iterable -- " href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Iterable"
class='dotted'>collections.abc.Iterable</a></dt>
<dd class="nested"></dd>
<dt class="nested"><small class='text-muted'><em><abbr title='Anything that is external to this library.'>extern</abbr> class</em></small> <a title="collections.abc.Container -- " href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Container"
class='dotted'>collections.abc.Container</a></dt>
<dd class="nested"></dd>
<dt class="nested"><small class='text-muted'><em><abbr title='Anything that is external to this library.'>extern</abbr> class</em></small> <a title="typing.Generic -- Abstract base class for generic types …" href="https://docs.python.org/3/library/typing.html#typing.Generic"
class='dotted'>Generic</a></dt>
<dd class="nested"><p>Abstract base class for generic types …</p></dd>
<dt class="nested"><small class='text-muted'><em><abbr title='Anything that is external to this library.'>extern</abbr> class</em></small> <a title="abc.ABC -- Helper class that provides a standard way to create an ABC using
inheritance." href="https://docs.python.org/3/library/abc.html#abc.ABC"
class='dotted'>abc.ABC</a></dt>
<dd class="nested"><p>Helper class that provides a standard way to create an ABC using
inheritance.</p></dd>
</dl>
<div class="sep"></div>
<h5>Methods</h5>
<dl>
<dt>
<pre><code id="hikari.utilities.mapping.DictionaryCollection.copy" class="hljs python"><abbr title='A standard Python function.'>def</abbr> copy() -> <a href='#hikari.utilities.mapping.DictionaryCollection'>DictionaryCollection</a>[~<a href='#hikari.utilities.mapping.KeyT'>KeyT</a>, ~<a href='#hikari.utilities.mapping.ValueT'>ValueT</a>]: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="MappedCollection -- The abstract class of mutable mappings used within hikari …" href="#hikari.utilities.mapping.MappedCollection"
class='dotted'>MappedCollection</a></code>.<code><a title="copy -- Return a copy of this mapped collection …" href="#hikari.utilities.mapping.MappedCollection.copy"
class='dotted'>copy</a></code>
</p>
<p>Return a copy of this mapped collection.</p>
<p>Unlike simply doing <code><a href='https://docs.python.org/3/library/stdtypes.html#dict'>dict</a>(<a href='https://docs.python.org/3/c-api/mapping.html#mapping'>mapping</a>)</code>, this may rely on internal detail
around how the data is being stored to allow for a more efficient copy.
This may look like calling <code><a href='https://docs.python.org/3/library/stdtypes.html#dict.copy'>dict.copy</a></code> and wrapping the result in a
mapped collection.</p>
<div class="alert alert-success">
<p class="admonition-title">Note</p>
<p>Any removal policy on this mapped collection will be copied over.</p>
</div>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='#hikari.utilities.mapping.MapT'>MapT</a>[<a href='#hikari.utilities.mapping.KeyT'>KeyT</a>, <a href='#hikari.utilities.mapping.ValueT'>ValueT</a>]</code></dt>
<dd>A copy of this mapped collection.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/nekokatt/hikari/blob/9b79731e2cd6e31eb8e2c5fed844a6d4527ac378/hikari/utilities/mapping.py#L104-L105" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def copy(self) -&gt; DictionaryCollection[KeyT, ValueT]:
    return DictionaryCollection(self._data.copy())</code></pre>
</details>
</dd>
<div class="sep"></div>
<dt>
<pre><code id="hikari.utilities.mapping.DictionaryCollection.freeze" class="hljs python"><abbr title='A standard Python function.'>def</abbr> freeze() -> Dict[~<a href='#hikari.utilities.mapping.KeyT'>KeyT</a>, ~<a href='#hikari.utilities.mapping.ValueT'>ValueT</a>]: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="MappedCollection -- The abstract class of mutable mappings used within hikari …" href="#hikari.utilities.mapping.MappedCollection"
class='dotted'>MappedCollection</a></code>.<code><a title="freeze -- Return a frozen mapping view of the items in this mapped collection …" href="#hikari.utilities.mapping.MappedCollection.freeze"
class='dotted'>freeze</a></code>
</p>
<p>Return a frozen mapping view of the items in this mapped collection.</p>
<p>Unlike simply doing <code><a href='https://docs.python.org/3/library/stdtypes.html#dict'>dict</a>(<a href='https://docs.python.org/3/c-api/mapping.html#mapping'>mapping</a>)</code>, this may rely on internal detail
around how the data is being stored to allow for a more efficient copy.
This may look like calling <code><a href='https://docs.python.org/3/library/stdtypes.html#dict.copy'>dict.copy</a></code>.</p>
<div class="alert alert-success">
<p class="admonition-title">Note</p>
<p>Unlike <code><a href='#hikari.utilities.mapping.MappedCollection.copy'>copy</a></code>, this should return a pure mapping
with no removal policy at all.</p>
</div>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='https://docs.python.org/3/library/typing.html#typing.MutableMapping'>MutableMapping</a>[<a href='#hikari.utilities.mapping.KeyT'>KeyT</a>, <a href='#hikari.utilities.mapping.ValueT'>ValueT</a>]</code></dt>
<dd>A frozen mapping view of the items in this mapped collection.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/nekokatt/hikari/blob/9b79731e2cd6e31eb8e2c5fed844a6d4527ac378/hikari/utilities/mapping.py#L107-L108" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def freeze(self) -&gt; typing.Dict[KeyT, ValueT]:
    return self._data.copy()</code></pre>
</details>
</dd>
<div class="sep"></div>
</dl>
<div class="sep"></div>
</dd>
<dt>
<h4><small class='text-muted'><em><abbr title='A standard Python type.'>class</abbr></em></small> <a title="MRIMutableMapping -- A most-recently-inserted limited mutable mapping implementation …" href="#hikari.utilities.mapping.MRIMutableMapping"
class='dotted'>MRIMutableMapping</a></h4>
</dt>
<dd>
<pre><code id="hikari.utilities.mapping.MRIMutableMapping" class="hljs python"><abbr title='A standard Python type.'>class</abbr> MRIMutableMapping (
    source: <a href='https://docs.python.org/3/library/typing.html#typing.Optional'>Optional</a>[<a href='https://docs.python.org/3/library/typing.html#typing.Dict'>Dict</a>[<a href='#hikari.utilities.mapping.KeyT'>KeyT</a>, <a href='https://docs.python.org/3/library/typing.html#typing.Tuple'>Tuple</a>[<a href='https://docs.python.org/3/library/functions.html#float'>float</a>, <a href='#hikari.utilities.mapping.ValueT'>ValueT</a>]]] = None,
    /,
    *,
    expiry: <a href='https://docs.python.org/3/library/datetime.html#datetime.timedelta'>datetime.timedelta</a>,
): ...</code></pre>
<p>A most-recently-inserted limited mutable mapping implementation.</p>
<p>This will remove entries on modification as as they pass the expiry limit.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>expiry</code></strong> :&ensp;<code><a href='https://docs.python.org/3/library/datetime.html#datetime.timedelta'>datetime.timedelta</a></code></dt>
<dd>The timedelta of how long entries should be stored for before removal.</dd>
<dt><strong><code>source</code></strong> :&ensp;<code>typing.Optional[typing.Dict[KeyT, typing.Tuple[builtins.float, ValueT]]</code></dt>
<dd>A source dictionary of keys to tuples of float timestamps and values to
create this from.</dd>
</dl>
<div class="sep"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/nekokatt/hikari/blob/9b79731e2cd6e31eb8e2c5fed844a6d4527ac378/hikari/utilities/mapping.py#L148-L212" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">class MRIMutableMapping(MappedCollection[KeyT, ValueT]):
    &#34;&#34;&#34;A most-recently-inserted limited mutable mapping implementation.

    This will remove entries on modification as as they pass the expiry limit.

    Parameters
    ----------
    expiry : datetime.timedelta
        The timedelta of how long entries should be stored for before removal.
    source : typing.Optional[typing.Dict[KeyT, typing.Tuple[builtins.float, ValueT]]
        A source dictionary of keys to tuples of float timestamps and values to
        create this from.
    &#34;&#34;&#34;

    __slots__ = (&#34;_data&#34;, &#34;_expiry&#34;)

    def __init__(
        self,
        source: typing.Optional[typing.Dict[KeyT, typing.Tuple[float, ValueT]]] = None,
        /,
        *,
        expiry: datetime.timedelta,
    ) -&gt; None:
        if expiry &lt;= datetime.timedelta():
            raise ValueError(&#34;expiry time must be greater than 0 microseconds.&#34;)

        self._expiry: float = expiry.total_seconds()
        self._data = source or {}
        self._garbage_collect()

    def copy(self) -&gt; MRIMutableMapping[KeyT, ValueT]:
        return MRIMutableMapping(self._data.copy(), expiry=datetime.timedelta(seconds=self._expiry))

    def freeze(self) -&gt; typing.MutableMapping[KeyT, ValueT]:
        return _FrozenMRIMapping(self._data.copy())

    def _garbage_collect(self) -&gt; None:
        current_time = time.perf_counter()
        for key, value in tuple(self._data.items()):
            if current_time - value[0] &lt; self._expiry:
                break

            del self._data[key]

    def __delitem__(self, key: KeyT) -&gt; None:
        del self._data[key]
        self._garbage_collect()

    def __getitem__(self, key: KeyT) -&gt; ValueT:
        return self._data[key][1]

    def __iter__(self) -&gt; typing.Iterator[KeyT]:
        return iter(self._data)

    def __len__(self) -&gt; int:
        return len(self._data)

    def __setitem__(self, key: KeyT, value: ValueT) -&gt; None:
        #  Seeing as we rely on insertion order in _garbage_collect, we have to make sure that each item is added to
        #  the end of the dict.
        if key in self:
            del self[key]

        self._data[key] = (time.perf_counter(), value)
        self._garbage_collect()</code></pre>
</details>
<div class="sep"></div>
<h5>Method resolution order</h5>
<dl>
<dt class="nested"><small class='text-muted'><em><abbr title='A standard Python type.'>class</abbr></em></small> <a title="MRIMutableMapping -- A most-recently-inserted limited mutable mapping implementation …" href="#hikari.utilities.mapping.MRIMutableMapping"
class='dotted'>MRIMutableMapping</a></dt>
<dd class="nested"><em class="text-muted">That's this class!</em></dd>
<dt class="nested"><small class='text-muted'><em><abbr title='An abstract base class which may have abstract methods and abstract properties.'>abstract</abbr> <abbr title='A standard Python type.'>class</abbr></em></small> <a title="MappedCollection -- The abstract class of mutable mappings used within hikari …" href="#hikari.utilities.mapping.MappedCollection"
class='dotted'>MappedCollection</a></dt>
<dd class="nested"><p>The abstract class of mutable mappings used within hikari …</p></dd>
<dt class="nested"><small class='text-muted'><em><abbr title='Anything that is external to this library.'>extern</abbr> class</em></small> <a title="collections.abc.MutableMapping -- " href="https://docs.python.org/3/library/collections.abc.html#collections.abc.MutableMapping"
class='dotted'>collections.abc.MutableMapping</a></dt>
<dd class="nested"></dd>
<dt class="nested"><small class='text-muted'><em><abbr title='Anything that is external to this library.'>extern</abbr> class</em></small> <a title="collections.abc.Mapping -- " href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping"
class='dotted'>collections.abc.Mapping</a></dt>
<dd class="nested"></dd>
<dt class="nested"><small class='text-muted'><em><abbr title='Anything that is external to this library.'>extern</abbr> class</em></small> <a title="collections.abc.Collection -- " href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Collection"
class='dotted'>collections.abc.Collection</a></dt>
<dd class="nested"></dd>
<dt class="nested"><small class='text-muted'><em><abbr title='Anything that is external to this library.'>extern</abbr> class</em></small> <a title="collections.abc.Sized -- " href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sized"
class='dotted'>collections.abc.Sized</a></dt>
<dd class="nested"></dd>
<dt class="nested"><small class='text-muted'><em><abbr title='Anything that is external to this library.'>extern</abbr> class</em></small> <a title="collections.abc.Iterable -- " href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Iterable"
class='dotted'>collections.abc.Iterable</a></dt>
<dd class="nested"></dd>
<dt class="nested"><small class='text-muted'><em><abbr title='Anything that is external to this library.'>extern</abbr> class</em></small> <a title="collections.abc.Container -- " href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Container"
class='dotted'>collections.abc.Container</a></dt>
<dd class="nested"></dd>
<dt class="nested"><small class='text-muted'><em><abbr title='Anything that is external to this library.'>extern</abbr> class</em></small> <a title="typing.Generic -- Abstract base class for generic types …" href="https://docs.python.org/3/library/typing.html#typing.Generic"
class='dotted'>Generic</a></dt>
<dd class="nested"><p>Abstract base class for generic types …</p></dd>
<dt class="nested"><small class='text-muted'><em><abbr title='Anything that is external to this library.'>extern</abbr> class</em></small> <a title="abc.ABC -- Helper class that provides a standard way to create an ABC using
inheritance." href="https://docs.python.org/3/library/abc.html#abc.ABC"
class='dotted'>abc.ABC</a></dt>
<dd class="nested"><p>Helper class that provides a standard way to create an ABC using
inheritance.</p></dd>
</dl>
<div class="sep"></div>
<h5>Methods</h5>
<dl>
<dt>
<pre><code id="hikari.utilities.mapping.MRIMutableMapping.copy" class="hljs python"><abbr title='A standard Python function.'>def</abbr> copy() -> <a href='#hikari.utilities.mapping.MRIMutableMapping'>MRIMutableMapping</a>[~<a href='#hikari.utilities.mapping.KeyT'>KeyT</a>, ~<a href='#hikari.utilities.mapping.ValueT'>ValueT</a>]: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="MappedCollection -- The abstract class of mutable mappings used within hikari …" href="#hikari.utilities.mapping.MappedCollection"
class='dotted'>MappedCollection</a></code>.<code><a title="copy -- Return a copy of this mapped collection …" href="#hikari.utilities.mapping.MappedCollection.copy"
class='dotted'>copy</a></code>
</p>
<p>Return a copy of this mapped collection.</p>
<p>Unlike simply doing <code><a href='https://docs.python.org/3/library/stdtypes.html#dict'>dict</a>(<a href='https://docs.python.org/3/c-api/mapping.html#mapping'>mapping</a>)</code>, this may rely on internal detail
around how the data is being stored to allow for a more efficient copy.
This may look like calling <code><a href='https://docs.python.org/3/library/stdtypes.html#dict.copy'>dict.copy</a></code> and wrapping the result in a
mapped collection.</p>
<div class="alert alert-success">
<p class="admonition-title">Note</p>
<p>Any removal policy on this mapped collection will be copied over.</p>
</div>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='#hikari.utilities.mapping.MapT'>MapT</a>[<a href='#hikari.utilities.mapping.KeyT'>KeyT</a>, <a href='#hikari.utilities.mapping.ValueT'>ValueT</a>]</code></dt>
<dd>A copy of this mapped collection.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/nekokatt/hikari/blob/9b79731e2cd6e31eb8e2c5fed844a6d4527ac378/hikari/utilities/mapping.py#L178-L179" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def copy(self) -&gt; MRIMutableMapping[KeyT, ValueT]:
    return MRIMutableMapping(self._data.copy(), expiry=datetime.timedelta(seconds=self._expiry))</code></pre>
</details>
</dd>
<div class="sep"></div>
<dt>
<pre><code id="hikari.utilities.mapping.MRIMutableMapping.freeze" class="hljs python"><abbr title='A standard Python function.'>def</abbr> freeze() -> MutableMapping[~<a href='#hikari.utilities.mapping.KeyT'>KeyT</a>, ~<a href='#hikari.utilities.mapping.ValueT'>ValueT</a>]: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="MappedCollection -- The abstract class of mutable mappings used within hikari …" href="#hikari.utilities.mapping.MappedCollection"
class='dotted'>MappedCollection</a></code>.<code><a title="freeze -- Return a frozen mapping view of the items in this mapped collection …" href="#hikari.utilities.mapping.MappedCollection.freeze"
class='dotted'>freeze</a></code>
</p>
<p>Return a frozen mapping view of the items in this mapped collection.</p>
<p>Unlike simply doing <code><a href='https://docs.python.org/3/library/stdtypes.html#dict'>dict</a>(<a href='https://docs.python.org/3/c-api/mapping.html#mapping'>mapping</a>)</code>, this may rely on internal detail
around how the data is being stored to allow for a more efficient copy.
This may look like calling <code><a href='https://docs.python.org/3/library/stdtypes.html#dict.copy'>dict.copy</a></code>.</p>
<div class="alert alert-success">
<p class="admonition-title">Note</p>
<p>Unlike <code><a href='#hikari.utilities.mapping.MappedCollection.copy'>copy</a></code>, this should return a pure mapping
with no removal policy at all.</p>
</div>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='https://docs.python.org/3/library/typing.html#typing.MutableMapping'>MutableMapping</a>[<a href='#hikari.utilities.mapping.KeyT'>KeyT</a>, <a href='#hikari.utilities.mapping.ValueT'>ValueT</a>]</code></dt>
<dd>A frozen mapping view of the items in this mapped collection.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/nekokatt/hikari/blob/9b79731e2cd6e31eb8e2c5fed844a6d4527ac378/hikari/utilities/mapping.py#L181-L182" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def freeze(self) -&gt; typing.MutableMapping[KeyT, ValueT]:
    return _FrozenMRIMapping(self._data.copy())</code></pre>
</details>
</dd>
<div class="sep"></div>
</dl>
<div class="sep"></div>
</dd>
<dt>
<h4><small class='text-muted'><em><abbr title='A standard Python type.'>class</abbr></em></small> <a title="MappedCollection -- The abstract class of mutable mappings used within hikari …" href="#hikari.utilities.mapping.MappedCollection"
class='dotted'>MappedCollection</a></h4>
</dt>
<dd>
<pre><code id="hikari.utilities.mapping.MappedCollection" class="hljs python"><abbr title='A standard Python type.'>class</abbr> MappedCollection (
    *args,
    **kwds,
): ...</code></pre>
<p>The abstract class of mutable mappings used within hikari.</p>
<p>This extends <code><a href='https://docs.python.org/3/library/typing.html#typing.MutableMapping'>MutableMapping</a></code> with "copy" and "freeze" methods.</p>
<div class="sep"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/nekokatt/hikari/blob/9b79731e2cd6e31eb8e2c5fed844a6d4527ac378/hikari/utilities/mapping.py#L51-L93" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">class MappedCollection(typing.MutableMapping[KeyT, ValueT], abc.ABC):
    &#34;&#34;&#34;The abstract class of mutable mappings used within hikari.

    This extends `typing.MutableMapping` with &#34;copy&#34; and &#34;freeze&#34; methods.
    &#34;&#34;&#34;

    __slots__: typing.Sequence[str] = ()

    @abc.abstractmethod
    def copy(self: MapT) -&gt; MapT:
        &#34;&#34;&#34;Return a copy of this mapped collection.

        Unlike simply doing `dict(mapping)`, this may rely on internal detail
        around how the data is being stored to allow for a more efficient copy.
        This may look like calling `dict.copy` and wrapping the result in a
        mapped collection.

        !!! note
            Any removal policy on this mapped collection will be copied over.

        Returns
        -------
        MapT[KeyT, ValueT]
            A copy of this mapped collection.
        &#34;&#34;&#34;

    @abc.abstractmethod
    def freeze(self) -&gt; typing.MutableMapping[KeyT, ValueT]:
        &#34;&#34;&#34;Return a frozen mapping view of the items in this mapped collection.

        Unlike simply doing `dict(mapping)`, this may rely on internal detail
        around how the data is being stored to allow for a more efficient copy.
        This may look like calling `dict.copy`.

        !!! note
            Unlike `MappedCollection.copy`, this should return a pure mapping
            with no removal policy at all.

        Returns
        -------
        typing.MutableMapping[KeyT, ValueT]
            A frozen mapping view of the items in this mapped collection.
        &#34;&#34;&#34;</code></pre>
</details>
<div class="sep"></div>
<h5>Subclasses</h5>
<dl>
<dt class="nested"><small class='text-muted'><em><abbr title='A standard Python type.'>class</abbr></em></small> <a title="DMChannelMRUMutableMapping -- A specialised Most-recently-used limited mapping for DMs …" href="cache.html#hikari.utilities.cache.DMChannelMRUMutableMapping"
class='dotted'>DMChannelMRUMutableMapping</a></dt>
<dd class="nested"><p>A specialised Most-recently-used limited mapping for DMs …</p></dd>
<dt class="nested"><small class='text-muted'><em><abbr title='A standard Python type.'>class</abbr></em></small> <a title="CMRIMutableMapping -- Implementation of a capacity-limited most-recently-inserted mapping …" href="#hikari.utilities.mapping.CMRIMutableMapping"
class='dotted'>CMRIMutableMapping</a></dt>
<dd class="nested"><p>Implementation of a capacity-limited most-recently-inserted mapping …</p></dd>
<dt class="nested"><small class='text-muted'><em><abbr title='A standard Python type.'>class</abbr></em></small> <a title="DictionaryCollection -- A basic mapped collection that acts like a dictionary." href="#hikari.utilities.mapping.DictionaryCollection"
class='dotted'>DictionaryCollection</a></dt>
<dd class="nested"><p>A basic mapped collection that acts like a dictionary.</p></dd>
<dt class="nested"><small class='text-muted'><em><abbr title='A standard Python type.'>class</abbr></em></small> <a title="MRIMutableMapping -- A most-recently-inserted limited mutable mapping implementation …" href="#hikari.utilities.mapping.MRIMutableMapping"
class='dotted'>MRIMutableMapping</a></dt>
<dd class="nested"><p>A most-recently-inserted limited mutable mapping implementation …</p></dd>
</dl>
<div class="sep"></div>
<h5>Method resolution order</h5>
<dl>
<dt class="nested"><small class='text-muted'><em><abbr title='An abstract base class which may have abstract methods and abstract properties.'>abstract</abbr> <abbr title='A standard Python type.'>class</abbr></em></small> <a title="MappedCollection -- The abstract class of mutable mappings used within hikari …" href="#hikari.utilities.mapping.MappedCollection"
class='dotted'>MappedCollection</a></dt>
<dd class="nested"><em class="text-muted">That's this class!</em></dd>
<dt class="nested"><small class='text-muted'><em><abbr title='Anything that is external to this library.'>extern</abbr> class</em></small> <a title="collections.abc.MutableMapping -- " href="https://docs.python.org/3/library/collections.abc.html#collections.abc.MutableMapping"
class='dotted'>collections.abc.MutableMapping</a></dt>
<dd class="nested"></dd>
<dt class="nested"><small class='text-muted'><em><abbr title='Anything that is external to this library.'>extern</abbr> class</em></small> <a title="collections.abc.Mapping -- " href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping"
class='dotted'>collections.abc.Mapping</a></dt>
<dd class="nested"></dd>
<dt class="nested"><small class='text-muted'><em><abbr title='Anything that is external to this library.'>extern</abbr> class</em></small> <a title="collections.abc.Collection -- " href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Collection"
class='dotted'>collections.abc.Collection</a></dt>
<dd class="nested"></dd>
<dt class="nested"><small class='text-muted'><em><abbr title='Anything that is external to this library.'>extern</abbr> class</em></small> <a title="collections.abc.Sized -- " href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sized"
class='dotted'>collections.abc.Sized</a></dt>
<dd class="nested"></dd>
<dt class="nested"><small class='text-muted'><em><abbr title='Anything that is external to this library.'>extern</abbr> class</em></small> <a title="collections.abc.Iterable -- " href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Iterable"
class='dotted'>collections.abc.Iterable</a></dt>
<dd class="nested"></dd>
<dt class="nested"><small class='text-muted'><em><abbr title='Anything that is external to this library.'>extern</abbr> class</em></small> <a title="collections.abc.Container -- " href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Container"
class='dotted'>collections.abc.Container</a></dt>
<dd class="nested"></dd>
<dt class="nested"><small class='text-muted'><em><abbr title='Anything that is external to this library.'>extern</abbr> class</em></small> <a title="typing.Generic -- Abstract base class for generic types …" href="https://docs.python.org/3/library/typing.html#typing.Generic"
class='dotted'>Generic</a></dt>
<dd class="nested"><p>Abstract base class for generic types …</p></dd>
<dt class="nested"><small class='text-muted'><em><abbr title='Anything that is external to this library.'>extern</abbr> class</em></small> <a title="abc.ABC -- Helper class that provides a standard way to create an ABC using
inheritance." href="https://docs.python.org/3/library/abc.html#abc.ABC"
class='dotted'>abc.ABC</a></dt>
<dd class="nested"><p>Helper class that provides a standard way to create an ABC using
inheritance.</p></dd>
</dl>
<div class="sep"></div>
<h5>Methods</h5>
<dl>
<dt>
<pre><code id="hikari.utilities.mapping.MappedCollection.copy" class="hljs python"><abbr title='A standard Python function.'>def</abbr> copy(
    self: <a href='#hikari.utilities.mapping.MapT'>MapT</a>,
) -> ~<a href='#hikari.utilities.mapping.MapT'>MapT</a>: ...</code></pre>
</dt>
<dd>
<p>Return a copy of this mapped collection.</p>
<p>Unlike simply doing <code><a href='https://docs.python.org/3/library/stdtypes.html#dict'>dict</a>(<a href='https://docs.python.org/3/c-api/mapping.html#mapping'>mapping</a>)</code>, this may rely on internal detail
around how the data is being stored to allow for a more efficient copy.
This may look like calling <code><a href='https://docs.python.org/3/library/stdtypes.html#dict.copy'>dict.copy</a></code> and wrapping the result in a
mapped collection.</p>
<div class="alert alert-success">
<p class="admonition-title">Note</p>
<p>Any removal policy on this mapped collection will be copied over.</p>
</div>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='#hikari.utilities.mapping.MapT'>MapT</a>[<a href='#hikari.utilities.mapping.KeyT'>KeyT</a>, <a href='#hikari.utilities.mapping.ValueT'>ValueT</a>]</code></dt>
<dd>A copy of this mapped collection.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/nekokatt/hikari/blob/9b79731e2cd6e31eb8e2c5fed844a6d4527ac378/hikari/utilities/mapping.py#L59-L75" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">@abc.abstractmethod
def copy(self: MapT) -&gt; MapT:
    &#34;&#34;&#34;Return a copy of this mapped collection.

    Unlike simply doing `dict(mapping)`, this may rely on internal detail
    around how the data is being stored to allow for a more efficient copy.
    This may look like calling `dict.copy` and wrapping the result in a
    mapped collection.

    !!! note
        Any removal policy on this mapped collection will be copied over.

    Returns
    -------
    MapT[KeyT, ValueT]
        A copy of this mapped collection.
    &#34;&#34;&#34;</code></pre>
</details>
</dd>
<div class="sep"></div>
<dt>
<pre><code id="hikari.utilities.mapping.MappedCollection.freeze" class="hljs python"><abbr title='A standard Python function.'>def</abbr> freeze() -> MutableMapping[~<a href='#hikari.utilities.mapping.KeyT'>KeyT</a>, ~<a href='#hikari.utilities.mapping.ValueT'>ValueT</a>]: ...</code></pre>
</dt>
<dd>
<p>Return a frozen mapping view of the items in this mapped collection.</p>
<p>Unlike simply doing <code><a href='https://docs.python.org/3/library/stdtypes.html#dict'>dict</a>(<a href='https://docs.python.org/3/c-api/mapping.html#mapping'>mapping</a>)</code>, this may rely on internal detail
around how the data is being stored to allow for a more efficient copy.
This may look like calling <code><a href='https://docs.python.org/3/library/stdtypes.html#dict.copy'>dict.copy</a></code>.</p>
<div class="alert alert-success">
<p class="admonition-title">Note</p>
<p>Unlike <code><a href='#hikari.utilities.mapping.MappedCollection.copy'>copy</a></code>, this should return a pure mapping
with no removal policy at all.</p>
</div>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='https://docs.python.org/3/library/typing.html#typing.MutableMapping'>MutableMapping</a>[<a href='#hikari.utilities.mapping.KeyT'>KeyT</a>, <a href='#hikari.utilities.mapping.ValueT'>ValueT</a>]</code></dt>
<dd>A frozen mapping view of the items in this mapped collection.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/nekokatt/hikari/blob/9b79731e2cd6e31eb8e2c5fed844a6d4527ac378/hikari/utilities/mapping.py#L77-L93" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">@abc.abstractmethod
def freeze(self) -&gt; typing.MutableMapping[KeyT, ValueT]:
    &#34;&#34;&#34;Return a frozen mapping view of the items in this mapped collection.

    Unlike simply doing `dict(mapping)`, this may rely on internal detail
    around how the data is being stored to allow for a more efficient copy.
    This may look like calling `dict.copy`.

    !!! note
        Unlike `MappedCollection.copy`, this should return a pure mapping
        with no removal policy at all.

    Returns
    -------
    typing.MutableMapping[KeyT, ValueT]
        A frozen mapping view of the items in this mapped collection.
    &#34;&#34;&#34;</code></pre>
</details>
</dd>
<div class="sep"></div>
</dl>
<div class="sep"></div>
</dd>
</dl>
</section>
</div>
</div>
</div>
<!-- Search script and dependencies -->
<script>
const input = document.getElementById('lunr-search');
input.disabled = false;
input.form.addEventListener('submit', (ev) => {
ev.preventDefault();
const url = new URL(window.location);
url.searchParams.set('q', input.value);
history.replaceState({}, null, url.toString());
search(input.value);
});
const query = new URL(window.location).searchParams.get('q');
if (query)
search(query);
function search(query) {
const url = '../search.html#' + encodeURIComponent(query);
window.location.href = url;
};
</script>
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad()</script>
</body>
</html>